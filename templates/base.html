<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% block title %}TeenCivics - Congressional Bills for Teens{% endblock %}</title>
  <meta name="description" content="{% block meta_description %}Understand congressional bills made simple for teenagers. Read AI-summarized bills, vote in polls, and learn about how government works.{% endblock %}">
  <meta name="keywords" content="congress, bills, government, politics, teens, education, civic engagement">
  <meta name="author" content="Liv Skeete - TeenCivics">

  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="{% block og_url %}https://teencivics.org{{ request.path }}{% endblock %}">
  <meta property="og:title" content="{% block og_title %}TeenCivics - Congressional Bills for Teens{% endblock %}">
  <meta property="og:description" content="{% block og_description %}Understand congressional bills made simple for teenagers. Read AI-summarized bills, vote in polls, and learn about how government works.{% endblock %}">
  <meta property="og:image" content="{% block og_image %}{{ url_for('static', filename='img/og-default.png', _external=True) }}{% endblock %}">

  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:url" content="{% block twitter_url %}https://teencivics.org{{ request.path }}{% endblock %}">
  <meta property="twitter:title" content="{% block twitter_title %}TeenCivics - Congressional Bills for Teens{% endblock %}">
  <meta property="twitter:description" content="{% block twitter_description %}Understand congressional bills made simple for teenagers. Read AI-summarized bills, vote in polls, and learn about how government works.{% endblock %}">
  <meta property="twitter:image" content="{% block twitter_image %}{{ url_for('static', filename='img/og-default.png', _external=True) }}{% endblock %}">
  <meta property="twitter:site" content="@TeenCivics">
  <meta property="twitter:creator" content="@TeenCivics">

  <!-- Canonical URL for SEO -->
  <link rel="canonical" href="https://teencivics.org{{ request.path }}">

  <!-- Favicons -->
  <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}">
  <link rel="icon" type="image/png" sizes="16x16" href="{{ url_for('static', filename='favicon-16x16.png') }}">
  <link rel="icon" type="image/png" sizes="32x32" href="{{ url_for('static', filename='favicon-32x32.png') }}">
  <link rel="apple-touch-icon" sizes="180x180" href="{{ url_for('static', filename='apple-touch-icon.png') }}">
  <meta name="theme-color" content="#1A237E">

  <!-- Preconnect to external domains for performance -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://www.googletagmanager.com">

  <!-- No-flash theme initializer: set data-theme before CSS loads -->
  <script>
    (function() {
      try {
        // Get saved theme preference
        var saved = localStorage.getItem('theme');
        
        // Apply saved theme immediately
        if (saved === 'dark') {
          document.documentElement.setAttribute('data-theme', 'dark');
        } else if (!saved) {
          // No saved preference - check system preference
          if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.setAttribute('data-theme', 'dark');
          }
        }
        // If saved === 'light', do nothing (default CSS is light)
      } catch (e) {
        // Fallback for Safari private mode
        try {
          if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.setAttribute('data-theme', 'dark');
          }
        } catch (_) {}
      }
    })();
  </script>
  <!-- CSS with cache busting -->
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css', v='2026-02-05-v8') }}">
  
  <!-- Google Fonts - Load only weights we actually use -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <!-- Page-specific CSS injection point -->
  {% block extra_css %}{% endblock %}

  <!-- Google Analytics -->
  {% if ga_measurement_id %}
  <script async src="https://www.googletagmanager.com/gtag/js?id={{ ga_measurement_id }}"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', '{{ ga_measurement_id }}', {
      'anonymize_ip': true,
      'cookie_flags': 'SameSite=None;Secure'
    });
  </script>
  {% endif %}

  <!-- Structured Data for SEO -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "TeenCivics",
    "url": "https://teencivics.org",
    "description": "Making congressional bills accessible and understandable for teenagers through AI-powered summaries.",
    "author": {
      "@type": "Person",
      "name": "Liv Skeete"
    },
    "potentialAction": {
      "@type": "SearchAction",
      "target": "https://teencivics.org/archive?q={search_term_string}",
      "query-input": "required name=search_term_string"
    }
  }
  </script>

  <link rel="sitemap" type="application/xml" title="Sitemap" href="/sitemap.xml">
</head>
<body>
  <!-- Skip to main content link for accessibility -->
  <a href="#main-content" class="skip-to-content">Skip to main content</a>

  <!-- Navigation -->
  <nav class="navbar" role="navigation" aria-label="Main navigation">
    <div class="nav-container">
      <a href="{{ url_for('index') }}" class="nav-logo" aria-label="TeenCivics home">
        <img src="{{ url_for('static', filename='icon-removebg-preview-2.png') }}" alt="" class="nav-logo-img" width="390" height="382" decoding="async" fetchpriority="high" role="presentation">
        <h1>TeenCivics</h1>
      </a>
      <div class="nav-menu" id="nav-menu">
        <a href="{{ url_for('index') }}" class="nav-link" {% if request.endpoint == 'index' %}aria-current="page"{% endif %}>Home</a>
        <a href="{{ url_for('archive') }}" class="nav-link" {% if request.endpoint == 'archive' %}aria-current="page"{% endif %}>Archive</a>
        <a href="{{ url_for('resources') }}" class="nav-link" {% if request.endpoint == 'resources' %}aria-current="page"{% endif %}>Resources</a>
        <a href="{{ url_for('about') }}" class="nav-link" {% if request.endpoint == 'about' %}aria-current="page"{% endif %}>About</a>
        <a href="{{ url_for('contact') }}" class="nav-link" {% if request.endpoint == 'contact' %}aria-current="page"{% endif %}>Contact</a>
      </div>
      <button class="nav-toggle" aria-label="Toggle navigation menu" aria-expanded="false" aria-controls="nav-menu">
        <span class="bar"></span><span class="bar"></span><span class="bar"></span>
      </button>
    </div>
  </nav>

  <!-- Main Content -->
  <main class="main-content" id="main-content">
    {% block content %}{% endblock %}
  </main>

  <!-- Footer -->
  <footer class="footer" role="contentinfo">
    <div class="footer-container">
      <div class="footer-section">
        <h3>TeenCivics</h3>
        <p>Making congressional bills accessible and understandable for teenagers through AI-powered summaries.</p>
        <p class="footer-credit">Created by <a href="{{ url_for('about') }}" style="color: var(--color-white); text-decoration: underline;">Liv Skeete</a></p>
      </div>
      <div class="footer-section">
        <h4>Quick Links</h4>
        <a href="{{ url_for('index') }}">Home</a>
        <a href="{{ url_for('archive') }}">Bill Archive</a>
        <a href="{{ url_for('resources') }}">Resources</a>
        <a href="{{ url_for('about') }}">About</a>
      </div>
      <div class="footer-section">
        <h4>Connect</h4>
        <a href="https://twitter.com/TeenCivics" target="_blank" rel="noopener" aria-label="Follow TeenCivics on Twitter">Twitter</a>
        <a href="{{ url_for('contact') }}">Contact</a>
        <a href="https://github.com/liv-skeete/teen_civics" target="_blank" rel="noopener" aria-label="View source code on GitHub">GitHub</a>
      </div>
    </div>
    <div class="footer-bottom">
      <p>&copy; {{ current_year }} TeenCivics. Created by Liv Skeete.</p>
      <p class="footer-tech">Built with Python Flask, PostgreSQL, and Claude AI</p>
    </div>
  </footer>

  <!-- Floating Theme Toggle -->
  <button id="floating-theme-toggle" class="floating-theme-toggle" aria-label="Toggle dark mode">
    <svg class="theme-icon sun-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>
    <svg class="theme-icon moon-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
  </button>

  <!-- JavaScript with cache busting and proper defer -->
  <script defer src="{{ url_for('static', filename='script.js', v='2026-02-05-v2') }}"></script>
  <script defer src="{{ url_for('static', filename='theme.js', v='2026-02-05-v2') }}"></script>

  <!-- Fallback: ensure floating theme toggle works even if theme.js is cached/old -->
  <script>
    (function() {
      var setupFloatingToggleFallback = function() {
        var btn = document.getElementById('floating-theme-toggle');
        if (!btn) return;

        // If a handler has already been bound (by theme.js or another script), skip
        if (btn.dataset.floatingToggleBound === '1') return;
        btn.dataset.floatingToggleBound = '1';

        btn.addEventListener('click', function() {
          var root = document.documentElement;
          var current = root.getAttribute('data-theme');
          var next = current === 'dark' ? 'light' : 'dark';
          root.setAttribute('data-theme', next);
          try {
            localStorage.setItem('theme', next);
          } catch (e) {
            // Ignore storage errors (e.g., private mode)
          }
        });
      };

      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', setupFloatingToggleFallback);
      } else {
        setupFloatingToggleFallback();
      }
    })();
  </script>

  {% block extra_js %}{% endblock %}
</body>
</html>