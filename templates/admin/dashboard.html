{% extends "base.html" %}

{% block title %}Admin Dashboard - TeenCivics{% endblock %}
{% block meta_description %}TeenCivics Admin Dashboard{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='admin.css', v='2026-02-08-v1') }}">
{% endblock %}

{% block content %}
<div class="admin-container">
  <div class="admin-header">
    <h2>ğŸ“Š Admin Dashboard</h2>
    <a href="{{ url_for('admin_logout') }}" class="btn btn-secondary admin-logout-btn">Logout</a>
  </div>

  <div class="admin-stats-grid">
    <div class="admin-stat-card">
      <div class="admin-stat-number">{{ total_bills }}</div>
      <div class="admin-stat-label">Total Bills</div>
    </div>
    <div class="admin-stat-card">
      <div class="admin-stat-number">{{ recently_edited }}</div>
      <div class="admin-stat-label">Edited (Last 7 Days)</div>
    </div>
  </div>

  <div class="admin-nav-cards">
    <a href="{{ url_for('admin_bills') }}" class="admin-nav-card admin-nav-card-primary">
      <h3>ğŸ“‹ Bills Management</h3>
      <p>View, search, and edit all bills in the database.</p>
    </a>
    <a href="{{ url_for('admin_tables') }}" class="admin-nav-card">
      <h3>ğŸ—„ï¸ Table Browser</h3>
      <p>Browse all database tables and edit individual rows.</p>
    </a>
  </div>

  {% if recent_edits %}
  <div class="admin-section">
    <h3>Recent Edits</h3>
    <div class="admin-table-wrapper">
      <table class="admin-table">
        <thead>
          <tr>
            <th>Bill ID</th>
            <th>Title</th>
            <th>Edited At</th>
            <th>Edited By</th>
          </tr>
        </thead>
        <tbody>
          {% for bill in recent_edits %}
          <tr>
            <td><a href="{{ url_for('admin_bill_summary', bill_id=bill.bill_id) }}">{{ bill.bill_id }}</a></td>
            <td>{{ bill.title[:80] }}{% if bill.title|length > 80 %}â€¦{% endif %}</td>
            <td>{{ bill.last_edited_at|format_datetime_simple if bill.last_edited_at else 'N/A' }}</td>
            <td>{{ bill.last_edited_by or 'N/A' }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
  {% endif %}
</div>
{% endblock %}
